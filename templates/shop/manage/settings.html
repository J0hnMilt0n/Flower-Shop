{% extends 'base.html' %}

{% block title %}Settings | Daisy Dreams Admin{% endblock %}

{% block content %}
<div class="bg-gradient-to-r from-primary-500 to-primary-600 py-8">
    <div class="container mx-auto px-4">
        <div>
            <h1 class="font-display text-3xl md:text-4xl font-bold text-white">Site Settings</h1>
            <p class="text-primary-100 mt-2">Manage site-wide configurations</p>
        </div>
    </div>
</div>

<div class="container mx-auto px-4 py-8">
    <div class="grid lg:grid-cols-4 gap-6">
        <!-- Sidebar Navigation -->
        <div class="lg:col-span-1">
            <div class="bg-white rounded-xl shadow-sm p-4">
                <nav class="space-y-2">
                    <a href="{% url 'shop:product_management' %}" class="flex items-center px-4 py-3 text-gray-700 hover:bg-gray-50 rounded-lg transition">
                        <i class="fas fa-box mr-3"></i>
                        Products
                    </a>
                    <a href="{% url 'shop:category_management' %}" class="flex items-center px-4 py-3 text-gray-700 hover:bg-gray-50 rounded-lg transition">
                        <i class="fas fa-tags mr-3"></i>
                        Categories
                    </a>
                    <a href="{% url 'shop:order_management' %}" class="flex items-center px-4 py-3 text-gray-700 hover:bg-gray-50 rounded-lg transition">
                        <i class="fas fa-shopping-bag mr-3"></i>
                        Orders
                    </a>
                    <a href="{% url 'shop:settings_management' %}" class="flex items-center px-4 py-3 bg-primary-50 text-primary-600 rounded-lg font-medium">
                        <i class="fas fa-cog mr-3"></i>
                        Settings
                    </a>
                </nav>
            </div>
        </div>

        <!-- Main Content -->
        <div class="lg:col-span-3">
            <form method="POST" class="space-y-6">
                {% csrf_token %}

                <!-- Payment Settings -->
                <div class="bg-white rounded-xl shadow-sm p-6">
                    <h2 class="text-xl font-semibold mb-6 flex items-center">
                        <i class="fas fa-credit-card text-primary-600 mr-3"></i>
                        Payment Settings
                    </h2>
                    
                    <div class="space-y-4">
                        <div class="flex items-center justify-between p-4 bg-gray-50 rounded-lg">
                            <div>
                                <h3 class="font-medium text-gray-800">Cash on Delivery (COD)</h3>
                                <p class="text-sm text-gray-600 mt-1">Allow customers to pay with Cash on Delivery</p>
                            </div>
                            <label class="relative inline-flex items-center cursor-pointer">
                                <input type="checkbox" name="enable_cod" class="sr-only peer" {% if settings.enable_cod %}checked{% endif %}>
                                <div class="w-14 h-7 bg-gray-300 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-primary-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-0.5 after:left-[4px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-6 after:w-6 after:transition-all peer-checked:bg-primary-600"></div>
                            </label>
                        </div>
                    </div>
                </div>

                <!-- Delivery Settings -->
                <div class="bg-white rounded-xl shadow-sm p-6">
                    <h2 class="text-xl font-semibold mb-6 flex items-center">
                        <i class="fas fa-truck text-primary-600 mr-3"></i>
                        Delivery Settings
                    </h2>
                    
                    <div class="grid md:grid-cols-2 gap-6">
                        <div>
                            <label class="block text-gray-700 font-medium mb-2">Free Delivery Above (₹)</label>
                            <input type="number" name="free_delivery_threshold" value="{{ settings.free_delivery_threshold }}" step="0.01"
                                   class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent">
                            <p class="text-sm text-gray-500 mt-1">Minimum order value for free delivery</p>
                        </div>
                        <div>
                            <label class="block text-gray-700 font-medium mb-2">Standard Delivery Charge (₹)</label>
                            <input type="number" name="standard_delivery_charge" value="{{ settings.standard_delivery_charge }}" step="0.01"
                                   class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent">
                            <p class="text-sm text-gray-500 mt-1">Charge for orders below threshold</p>
                        </div>
                    </div>
                </div>

                <!-- Store Status -->
                <div class="bg-white rounded-xl shadow-sm p-6">
                    <h2 class="text-xl font-semibold mb-6 flex items-center">
                        <i class="fas fa-store text-primary-600 mr-3"></i>
                        Store Status
                    </h2>
                    
                    <div class="space-y-4">
                        <div class="flex items-center justify-between p-4 bg-gray-50 rounded-lg">
                            <div>
                                <h3 class="font-medium text-gray-800">Store Open</h3>
                                <p class="text-sm text-gray-600 mt-1">Allow new orders to be placed</p>
                            </div>
                            <label class="relative inline-flex items-center cursor-pointer">
                                <input type="checkbox" name="store_open" class="sr-only peer" {% if settings.store_open %}checked{% endif %}>
                                <div class="w-14 h-7 bg-gray-300 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-primary-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-0.5 after:left-[4px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-6 after:w-6 after:transition-all peer-checked:bg-green-600"></div>
                            </label>
                        </div>

                        <div class="flex items-center justify-between p-4 bg-gray-50 rounded-lg">
                            <div>
                                <h3 class="font-medium text-gray-800">Maintenance Mode</h3>
                                <p class="text-sm text-gray-600 mt-1">Display maintenance message to customers</p>
                            </div>
                            <label class="relative inline-flex items-center cursor-pointer">
                                <input type="checkbox" name="maintenance_mode" id="maintenance_mode" class="sr-only peer" {% if settings.maintenance_mode %}checked{% endif %}>
                                <div class="w-14 h-7 bg-gray-300 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-primary-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-0.5 after:left-[4px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-6 after:w-6 after:transition-all peer-checked:bg-yellow-600"></div>
                            </label>
                        </div>

                        <div id="maintenance_message_wrapper" class="{% if not settings.maintenance_mode %}hidden{% endif %}">
                            <label class="block text-gray-700 font-medium mb-2">Maintenance Message</label>
                            <textarea name="maintenance_message" rows="3"
                                      class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent"
                                      placeholder="Message to display during maintenance...">{{ settings.maintenance_message }}</textarea>
                        </div>
                    </div>
                </div>

                <!-- Contact Information -->
                <div class="bg-white rounded-xl shadow-sm p-6">
                    <h2 class="text-xl font-semibold mb-6 flex items-center">
                        <i class="fas fa-phone text-primary-600 mr-3"></i>
                        Contact Information
                    </h2>
                    
                    <div class="grid md:grid-cols-2 gap-6">
                        <div>
                            <label class="block text-gray-700 font-medium mb-2">Contact Email</label>
                            <input type="email" name="contact_email" value="{{ settings.contact_email }}"
                                   class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent"
                                   placeholder="contact@flowershop.com">
                        </div>
                        <div>
                            <label class="block text-gray-700 font-medium mb-2">Contact Phone</label>
                            <input type="tel" name="contact_phone" value="{{ settings.contact_phone }}"
                                   class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent"
                                   placeholder="+91 1234567890">
                        </div>
                        <div>
                            <label class="block text-gray-700 font-medium mb-2">WhatsApp Number</label>
                            <input type="tel" name="whatsapp_number" value="{{ settings.whatsapp_number }}"
                                   class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent"
                                   placeholder="+91 1234567890">
                        </div>
                    </div>
                </div>

                <!-- Save Button -->
                <div class="flex items-center justify-between bg-white rounded-xl shadow-sm p-6">
                    <div class="text-sm text-gray-500">
                        {% if settings.updated_at %}
                        Last updated: {{ settings.updated_at|date:"M d, Y h:i A" }}
                        {% if settings.updated_by %}by {{ settings.updated_by.username }}{% endif %}
                        {% endif %}
                    </div>
                    <button type="submit" class="bg-primary-600 text-white px-8 py-3 rounded-lg font-semibold hover:bg-primary-700 transition shadow-lg">
                        <i class="fas fa-save mr-2"></i> Save Changes
                    </button>
                </div>
            </form>
        </div>
    </div>
</div>

{% endblock %}

{% block extra_js %}
<script>
    // Toggle maintenance message visibility
    document.getElementById('maintenance_mode').addEventListener('change', function() {
        const messageWrapper = document.getElementById('maintenance_message_wrapper');
        if (this.checked) {
            messageWrapper.classList.remove('hidden');
        } else {
            messageWrapper.classList.add('hidden');
        }
    });
</script>
{% endblock %}
